### Admin Service API Tests

@baseUrl = http://localhost:5006
@userId = 550e8400-e29b-41d4-a716-446655440000
@roleId = 715a8e62-2139-42bf-88e1-ea94c9e7e5bb

### Health Check
GET {{baseUrl}}/api/admin/health

### Get Active Templates
GET {{baseUrl}}/api/admin/templates

### Get Templates by Category
GET {{baseUrl}}/api/admin/templates/category/portfolio

### Create Template
POST {{baseUrl}}/api/admin/templates
Content-Type: application/json

{
  "name": "Portfolio Template",
  "category": "portfolio",
  "description": "Professional portfolio showcase",
  "thumbnailUrl": "https://example.com/thumb.jpg",
  "htmlTemplate": "<div class='portfolio'></div>",
  "cssTemplate": ".portfolio { display: grid; }",
  "priority": 1
}

### Get Audit Logs
GET {{baseUrl}}/api/admin/audit-logs?limit=50

### Get Setting
GET {{baseUrl}}/api/admin/settings/max_projects_per_user

### Set Setting
POST {{baseUrl}}/api/admin/settings
Content-Type: application/json

{
  "key": "max_projects_per_user",
  "value": "100"
}

### Delete Setting
DELETE {{baseUrl}}/api/admin/settings/max_projects_per_user

### --- USER MANAGEMENT (PHASE 2) ---

### Get All Users
GET {{baseUrl}}/api/admin/users

### Get User by ID
GET {{baseUrl}}/api/admin/users/{{userId}}

### Create New Admin User
POST {{baseUrl}}/api/admin/users
Content-Type: application/json

{
  "email": "admin@techbirdsfly.com",
  "fullName": "Admin User"
}

### Update User
PUT {{baseUrl}}/api/admin/users/{{userId}}
Content-Type: application/json

{
  "fullName": "Updated User Name"
}

### Suspend User
POST {{baseUrl}}/api/admin/users/{{userId}}/suspend
Content-Type: application/json

{
  "reason": "Suspicious activity detected"
}

### Unsuspend User
POST {{baseUrl}}/api/admin/users/{{userId}}/unsuspend

### Ban User
POST {{baseUrl}}/api/admin/users/{{userId}}/ban
Content-Type: application/json

{
  "reason": "Violation of terms of service"
}

### Delete User
DELETE {{baseUrl}}/api/admin/users/{{userId}}

### --- ROLE MANAGEMENT (PHASE 2) ---

### Get All Roles
GET {{baseUrl}}/api/admin/roles

### Get Role by ID
GET {{baseUrl}}/api/admin/roles/{{roleId}}

### Create New Role
POST {{baseUrl}}/api/admin/roles
Content-Type: application/json

{
  "name": "Moderator",
  "description": "Can moderate user content",
  "permissions": ["manage_users", "view_analytics"]
}

### Update Role
PUT {{baseUrl}}/api/admin/roles/{{roleId}}
Content-Type: application/json

{
  "description": "Updated role description",
  "permissions": ["create_project", "view_own_projects", "generate_website", "view_analytics_summary"]
}

### Delete Role
DELETE {{baseUrl}}/api/admin/roles/{{roleId}}

### Assign Role to User
POST {{baseUrl}}/api/admin/users/{{userId}}/roles/{{roleId}}

### Revoke Role from User
DELETE {{baseUrl}}/api/admin/users/{{userId}}/roles/{{roleId}}

### Get User Roles
GET {{baseUrl}}/api/admin/users/{{userId}}/roles

### Get User Permissions
GET {{baseUrl}}/api/admin/users/{{userId}}/permissions

### --- ANALYTICS (PHASE 2) ---

### Get Daily Statistics
GET {{baseUrl}}/api/admin/analytics/daily/2025-10-17

### Get Statistics Range
GET {{baseUrl}}/api/admin/analytics/range?from=2025-10-01&to=2025-10-31

### Get Total Revenue
GET {{baseUrl}}/api/admin/analytics/revenue?from=2025-10-01&to=2025-10-31

### Get Websites Generated
GET {{baseUrl}}/api/admin/analytics/websites-generated?from=2025-10-01&to=2025-10-31

### Get Images Generated
GET {{baseUrl}}/api/admin/analytics/images-generated?from=2025-10-01&to=2025-10-31

### Get Average Generation Time
GET {{baseUrl}}/api/admin/analytics/avg-generation-time?from=2025-10-01&to=2025-10-31

### Get Failed Generations Count
GET {{baseUrl}}/api/admin/analytics/failed-generations?from=2025-10-01&to=2025-10-31

### Get Platform Summary (Last 30 Days)
GET {{baseUrl}}/api/admin/analytics/summary

### Record Daily Statistics
POST {{baseUrl}}/api/admin/analytics/record-daily
Content-Type: application/json

{
  "date": "2025-10-17",
  "newUsersCount": 25,
  "activeUsersCount": 150,
  "websitesGeneratedCount": 42,
  "imagesGeneratedCount": 128,
  "revenueTotal": 1250.50,
  "averageUserSpend": 8.34,
  "failedGenerations": 3,
  "averageGenerationTime": 4.5
}

### --- REAL-TIME MONITORING (PHASE 3.1) ---

### Real-Time Service Health Check
GET {{baseUrl}}/api/admin/realtime/health

### Real-Time Connection Status
GET {{baseUrl}}/api/admin/realtime/status

### Get Platform Snapshot (Immediate)
GET {{baseUrl}}/api/admin/realtime/platform-snapshot

### Broadcast Platform Update
POST {{baseUrl}}/api/admin/realtime/broadcast/platform-update

### Broadcast User Count Update
POST {{baseUrl}}/api/admin/realtime/broadcast/user-count

### Broadcast Generation Metrics
POST {{baseUrl}}/api/admin/realtime/broadcast/generation-metrics
Content-Type: application/json

{
  "websitesGenerated": 125,
  "imagesGenerated": 342,
  "failedGenerations": 5,
  "averageGenerationTime": 4.2
}

### Broadcast Revenue Update
POST {{baseUrl}}/api/admin/realtime/broadcast/revenue
Content-Type: application/json

{
  "dailyRevenue": 1250.75,
  "totalRevenue30d": 35420.50
}

### Send Generic Alert
POST {{baseUrl}}/api/admin/realtime/alert
Content-Type: application/json

{
  "type": "info",
  "message": "Test alert from API",
  "data": {
    "timestamp": "2025-10-17T10:30:00Z",
    "severity": "low"
  }
}

### Send Warning Alert
POST {{baseUrl}}/api/admin/realtime/alert/warning
Content-Type: application/json

{
  "message": "System performance degradation detected",
  "data": {
    "cpuUsage": 92,
    "memoryUsage": 88,
    "threshold": 85
  }
}

### Send Error Alert
POST {{baseUrl}}/api/admin/realtime/alert/error
Content-Type: application/json

{
  "message": "API rate limit exceeded for multiple users",
  "data": {
    "affectedUsers": 3,
    "limitExceeded": "1000 req/hour"
  }
}

### Send Performance Alert
POST {{baseUrl}}/api/admin/realtime/alert/performance
Content-Type: application/json

{
  "metric": "ApiResponseTime",
  "value": 2500,
  "threshold": "2000ms"
}

### Notify User Action
POST {{baseUrl}}/api/admin/realtime/notify/user-action
Content-Type: application/json

{
  "userId": "550e8400-e29b-41d4-a716-446655440000",
  "action": "website_generated",
  "details": {
    "projectId": "proj-12345",
    "templateId": "tmpl-789",
    "generationTime": 3.5
  }
}

### Notify Role Assignment
POST {{baseUrl}}/api/admin/realtime/notify/role-assignment
Content-Type: application/json

{
  "userId": "550e8400-e29b-41d4-a716-446655440000",
  "roleName": "Moderator",
  "action": "assigned"
}

### Notify System Event
POST {{baseUrl}}/api/admin/realtime/notify/system-event
Content-Type: application/json

{
  "eventType": "database_maintenance",
  "description": "Scheduled maintenance completed successfully",
  "data": {
    "duration": "15 minutes",
    "affectedServices": ["auth-service", "generator-service"],
    "status": "completed"
  }
}

### WebSocket Connection Example (JavaScript)
# Connect to: ws://localhost:5006/hubs/admin
# With Bearer token in Authorization header
#
# const connection = new signalR.HubConnectionBuilder()
#     .withUrl("http://localhost:5006/hubs/admin", {
#         accessTokenFactory: () => localStorage.getItem('token')
#     })
#     .withAutomaticReconnect()
#     .build();
#
# connection.on("ConnectionEstablished", (msg) => {
#     console.log("Connected:", msg);
# });
#
# connection.on("UserActivityUpdate", (data) => {
#     console.log("User Activity:", data);
# });
#
# connection.on("AnalyticsUpdate", (data) => {
#     console.log("Analytics:", data);
# });
#
# connection.on("SystemAlert", (data) => {
#     console.log("Alert:", data);
# });
#
# await connection.start();
#
# // Subscribe to updates
# await connection.invoke("SubscribeToUserActivity");
# await connection.invoke("SubscribeToAnalytics");
# await connection.invoke("SubscribeToAlerts");
